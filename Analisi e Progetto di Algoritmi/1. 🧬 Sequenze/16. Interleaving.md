
>[!Premise]
>Introduciamo la funzione $f, f : Σ^∗ → N$, così definita: 
>$∀S ∈ Σ^∗ , f(S) =$ numero minimo di caratteri da aggiungere per rendere S palindroma.

*Date tre sequenze, definite su un alfabeto $Σ$, $X = ⟨x_1, . . . , x_m⟩$ di lunghezza $m$, $Y = ⟨y_1, . . . , y_n⟩$ di lunghezza $n$ e $W = ⟨w_1, . . . , w_{m+n}⟩$ di lunghezza $m + n$, stabilire se $W$ è un interleaving di $X$ e $Y$ , ovvero se $X$ e $Y$ si possono trovare come due sottosequenze disgiunte in $W$.*

>[!Example]
>Ad esempio, date $X = ⟨C, I, A, O⟩$ e $Y = ⟨M, A, M, M, A⟩$, possiamo dire che $W = ⟨C, I, M, A, A, M, M, A, O⟩$ è interleaving di $X$ e $Y$ .

---
## Sottoproblemi

*Date tre sequenze $X$, $Y$ e $W$, rispettivamente di lunghezza $m$, $n$ e $m + n$, si determini se $W_{i+j}$ è interleaving di $X_i$ e $Y_j$.*

- Considerato il sottoproblema di dimensione $(i, j)$, la `variabile` ad esso associata è $s_{i,j}$ ed è così definita:
	- $s_{i,j}$ = $True$ se $W_{i+j}$ è interleaving di $X_i$ e $Y_j$, $False$ altrimenti

**Numero di sottoproblemi**: $(m+1)(n+1)$
**Soluzione del problema**: $s_{m, n}$

---
## Sottostruttura ottima

Date $X=⟨x_1, x_2, …, x_{m-1}, x_m⟩$ e $Y=⟨y_1, y_2, …, y_{n-1}, y_n⟩$:

- $x_m = y_n \Rightarrow LCS(X_{m-1}, Y_{n-1}) + ⟨x_m⟩$
- $x_m \neq y_n \Rightarrow max(LCS(X_{m-1}, Y_{n}), LCS(X_{m}, Y_{n-1}))$ 

---
## Equazioni di ricorrenza

Nella risoluzione di questo esercizio è più comodo procedere per casi in base ai prefissi di $X$, $Y$, $W$, senza da subito distinguere tra essi quelli che fan parte del caso base e quelli che fan parte del passo ricorsivo.

#### Primo caso: $i = 0 ∨ j = 0$
Quando uno dei due prefissi considerati è la sequenza vuota.
- $i = 0 ∧ j = 0$: se **entrambi i prefissi sono la sequenza vuota**, allora $W_{i+j}$ è la sequenza vuota e di consguenza sarà interleaving di $X_i$ e $Y_j$ $$s_{i,j} = True$$
- $i = 0 ∧ j > 0$: in questo caso bisogna considerare due situazioni diverse:
	- $w_j = y_j$ : se l’elemento $w_j$ è **uguale** all’elemento $y_j$, allora $W_{i+j}$ è interleaving di $X_i$ e $Y_j$ solo se lo era anche $W_{i+j−1}$ (ossia se $W_{i+j−1}$ era interleaving di $X_i$ e $Y_{j−1}$)$$s_{i,j} = s_{i,j−1}$$
	- $w_j \neq y_j$ : se l’elemento $w_j$ è diverso dall’elemento $y_j$ , allora $W_{i+j}$ non può essere interleaving di $X_i$ e $Y_j$ (dato che $X_i$ è la stringa vuota, l’unico modo è che $W_{i+j} = Y_j$) $$s_{i,j} = False$$
- $i > 0 ∧ j = 0$: anche in questo caso bisogna considerare due situazioni diverse:
	- $w_j = x_j$ : se l’elemento $w_i$ è **uguale** all’elemento $x_i$, allora $W_{i+j}$ è interleaving di $X_i$ e $Y_j$ solo se lo era anche $W_{i+j−1}$ (ossia se $W_{i+j−1}$ era interleaving di $X_{i-1}$ e $Y_j$)$$s_{i,j} = s_{i-1,j}$$
	- $w_j \neq y_j$ : se l’elemento $w_i$ è diverso dall’elemento $x_i$ , allora $W_{i+j}$ non può essere interleaving di $X_i$ e $Y_j$ (dato che $Y_j$ è la stringa vuota, l’unico modo è che $W_{i+j} = X_i$) $$s_{i,j} = False$$
- quindi 
$$s_{i, j} = 
\begin {cases}
True & i = 0 ∧ j = 0 \\
s_{i,j−1} & i = 0 ∧ j > 0 ∧ w_j = y_j \\
False & i = 0 ∧ j > 0 ∧ w_j \neq y_j \\
s_{i−1,j} & i > 0 ∧ j = 0 ∧ w_i = x_i \\
False & i > 0 ∧ j = 0 ∧ w_i \neq x_i \\
\end {cases}
$$

#### Primo caso: $i > 0 \land j > 0$
Si vanno a considerare due prefissi $X_i = ⟨x_1, . . . , x_i⟩$ e $Y_j = ⟨y_1, . . . , y_j ⟩$ entrambi **diversi dalla sequenza vuota**.

- $w_{i+j} \neq x_i ∧ w_{i+j} \neq y_j$ : se non possono essere accodati né $x_i$ né $y_j$ al simbolo in posizione $w_{i+j}$ allora $W_{i+j}$ non può essere interleaving di $X_i$ e $Y_j$ $$s_{i,j} = False$$
- $w_{i+j} = x_i ∧ w_{i+j} \neq y_j$ : siccome l’elemento $w_{i+j}$ è uguale all’elemento $x_i$ e diverso da $y_j$, allora l’unico carattere valido per la posizione $i + j$ in $W$ è proprio $x_i$. Quindi $W_{i+j}$ è interleaving di $X_i$ e $Y_j$ solo se lo era anche $W_{i+j−1}$ (ossia se $W_{i+j−1}$ era interleaving di $X_{i−1}$ e $Y_j$) $$s_{i,j} = s_{i−1,j}$$
- $w_{i+j} \neq x_i ∧ w_{i+j} = y_j$ : questo caso è lo speculare del precedente, infatti la soluzione `e data dalla soluzione di uno dei sottoproblemi di dimensione minore. Siccome l’elemento wi+j `e uguale all’elemento yj e diverso da xi , allora l’unico carattere valido per la posizione i + j in W `e proprio yj . Quindi Wi+j `e interleaving di Xi e Yj solo se lo era anche Wi+j−1 (ossia se 98 Wi+j−1 era interleaving di Xi e Yj−1).










#### <u>**Caso base**</u>: $i ≥ j$
- $i = j$: allora $S_{i,j}$ è composta da un solo carattere e quindi è palindroma, quindi $$m_{i,j} = 0$$
- $i > j$: allora $S_{i,j}$ è vuota e quindi è palindroma, quindi $$m_{i,j} = 0$$
- quindi $$m_{i,j} = 0 \quad\text{se } i\geq j$$
#### <u>**Passo ricorsivo**</u>: $i < j$
Il passo ricorsivo si ha per un qualunque sottoproblema di dimensione $(i, j)$ con $i < j$, ossia quando la sottostringa $S_{i,j}$ è composta da almeno due caratteri.
- $s_i = s_j$ : allora $S_{i,j}$ è palindroma se lo è anche $S_{i+1,j−1}$, quindi $$m_{i,j} = m_{i+1,j−1}$$
- $s_i \neq s_j$ : allora $S_{i,j}$ è palindroma se lo è anche $S_{i+1,j}$ o $S_{i,j−1}$, quindi $$m_{i,j} = min(m_{i+1,j} , m_{i,j−1}) + 1$$
- risulta quindi:
$$m_{i, j} = 
\begin {cases} 
0 & i ≥ j \\
m_{i+1,j−1} & i < j ∧ s_i = s_j \\
min(m_{i+1,j} , m_{i,j−1}) + 1 & i < j ∧ s_i \neq s_j
\end {cases}
$$

---
## Algoritmo DP

- uso una **matrice** $m[0...n][0...n]$ per salvare tutti i `sottoproblemi` $m_{i, j}$

``` Pseudocodice TI:"PAL" "FOLD"
def PAL(S) 
	for j from 1 to n do
		for i from j to n
			m[i, j] = 0
	for i from n-1 to 1 do
		for j from i + 1 to n do
			if s[i] = s[j] then
				m[i, j] = m[i+1, j-1]
			else
				M1 = m[i+1, j]
				M2 = m[i, j-1]
				m[i, j] = min(M1, M2)
	return m[1, n]
```

> [!Summary]
> - ***Complessità***: $O(n^2)$
> - ***Memoria***: $O(n^2)$

![[Pasted image 20231116153032.png]]