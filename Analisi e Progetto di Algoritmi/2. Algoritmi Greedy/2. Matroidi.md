Non tutti i problemi ammettono un algoritmo greedy.

*Come capire, in linea di principio, se un dato problema ammette un algoritmo greedy?*

>[!Note]
>Un **matroide** è una struttura combinatoria a cui è associato un *algoritmo greedy*.

---

## Sistema di Indipendenza

Una coppia $(S,F)$
- $S$, insieme finito $\{s_1, s_2, …, s_n\}$ di elementi 
- $F$, una famiglia di sottoinsiemi di $S$, cioè un sottoinsieme dell’insieme $P(S)$ delle parti di $S$

è un **Sistema di Indipendenza** se vale la seguente proprietà:
$$\text{per ogni } A ∈ F\text{, allora un qualsiasi } B ⊆ A \text{ appartiene a } F$$
$$∀A ∈ F, B ⊆ A \Longrightarrow B ∈ F$$

>[!Example]
>- $S = \{1, 2, . . . , n\}$ oggetti di peso: $c_i$ con $i ∈ (1, n)$
>- $F =$ tutti i sottoinsiemi di peso complessivo $≤ C$
>$(S, F)$ è un sistema di indipendenza dato che, preso un $A ∈ F$, il suo peso totale sarà sempre $≤ C$ e quindi $B$, che al massimo contiene tutti gli elementi di $A$, non può avere peso superiore.

---

## Matroide

Un sistema di indipendenza $(S,F)$ è un *matroide* se vale la seguente **proprietà di scambio**:
$$∀A, B ∈ F : |B| = |A| + 1 ⇒ ∃b ∈ (B − A) : \{b\} ∪ A ∈ F$$


>[!Note]
>In un matroide l’insieme vuoto è un insieme **indipendente**.

>[!Example]
>- $S = \{1, 2, . . . , n\}$ insieme di $n$ oggetti
>- $F =$ sottoinsiemi di $S$ di cardinalità $≤ k$.
>$(S, F)$ è un **matroide** in quanto: $|A| ≤ k$ e $|B| ≤ k$, ora so che $A$ ha un elemento in meno di $B$ e quindi $|A| < k$ (la cardinalità di $A$ deve essere minore di quella di $B$). Ora posso considerare un qualsiasi $b ∈ (B − A)$ ed aggiungerlo in $A$ ed ottenere un insieme di cardinalità $≤ k$.

---
## Insieme Massimale di un Matroide

Sia $M = (S,F)$ un **matroide**.
- Un elemento $s ∈ S$ è *estensione* di $A ∈ F$ se $\{s\} ∪ A ∈ F$.

$A ∈ F$ è **massimale se non ha estensioni**, ovvero non è contenuto in un insieme indipendente più grande.

>[!Important]
>Tutti gli insiemi **indipendenti massimali** di un matroide hanno la stessa dimensione.



---
## Matroide Grafico

Dato un grafo $G = (V, E)$ *non orientato e connesso*, definiamo il **matroide grafico** $M_G = (S, F)$ con:
$$S = \text{insieme } E \text{ degli archi}$$
$$F = \text{ tutti i sottoinsiemi aciclici di } S$$
Essendo un matroide, esso dovrà possedere le **proprietà dei matroidi**:
1. $∀A ∈ F, B ⊆ A \Longrightarrow B ∈ F$
2. $∀A, B ∈ F : |B| = |A| + 1 ⇒ ∃b ∈ (B − A) : \{b\} ∪ A ∈ F$

#### Insieme massimale di $M_G$

Sia $M_G = (S,F)$ un **matroide grafico**.
- **Insieme massimale**: 
$$A ∈ F \text{ (aciclico) che non ha estensioni} \Longrightarrow ∄ s ∈ S: \{s\} ∪ A ∈ F$$
$G_A = (V,A)$, se $A$ è massimale, è una foresta composta da un solo albero di $|V|-1$ archi che connette tutti i vertici del grafo. $G_A$ prende il nome di **Spanning Tree**.

>[!Note]
>Sia $A ∈ F$.
>- $G_A = (V, A)$ à foresta di $|V|-|A|$ alberi

---

## Matroide Pesato

Un **matroide pesato** è un matroide $M = (S,F)$ a cui viene associata una *funzione peso* $W$

$$W: S \rightarrow R^+$$
che associa ad ogni elemento un **peso**. La funzione $W$ si può estendere ad un insieme e ritornerà la **somma dei pesi** di tutti gli elementi che lo compongono.

>[!Note]
>**Sottoinsieme ottimo** $\rightarrow$ sottoinsieme *indipendente* di peso massimo (sicuramente massimale).

---

## Algoritmo Greedy Standard

``` Pseudocodice TI:"standard_greedy_algorithm" "FOLD"
def standard_greedy_algorithm(S = {s1, s2, …, sn}) 
	X = ∅
	Ordino S per peso W decrescente
	
	for i from 1 to n do
		if s[i] U X ∈ F then
			X = s[i] ∪ X
	
	return X
```

> [!Summary]
> - ***Complessità***: $O(n \log(n) + nf(n))$
> 
> dove:
> - $n \log(n)$ deriva dall'algoritmo di ordinamento di $S$
> - $f(n)$ è la funzione che serve per calcolare se $s_i ∪ X ∈ F$

---

## Teorema di Rado

*La coppia $(S, F)$ è un matroide **se e solo** se per ogni funzione peso $W$ l’algoritmo greedy standard fornisce una soluzione ottima.*

**Applicazioni**: 
- Dato un problema $P$ rappresentabile attraverso un matroide pesato, allora esisterà un *algoritmo greedy* per risolverlo per **qualsiasi funzione peso**.
- Se $P$ **non** è un matroide pesato, **non esiste** un *algoritmo greedy* per qualsiasi funzione peso

#### Dimostrazione

$$(S, F) \text{ è un matroide} \Longleftrightarrow \text{ Algoritmo greedy standard fornisce una soluzione ottima}$$

Supponiamo che $(S, F)$ sia un **matroide**. Vogliamo dimostrare che, per ogni funzione peso $W$, l’*algoritmo greedy standard* restituisce una **soluzione ottima**.

Sia $I$ un **sottoinsieme indipendente massimale** di $(S, F)$, e $W(I)$ il **peso** di $I$ secondo la funzione peso $W$. 
Vogliamo dimostrare che, in ogni passo dell’*algoritmo greedy standard*, quando aggiungiamo un elemento $s_i$ a $X$, la soluzione parziale $X$ è sempre **ottima** fino a quel punto.

Supponiamo per assurdo che, in un certo passo, l’algoritmo aggiunga un elemento $s_i$ a $X$, ma **esista** un sottoinsieme indipendente massimale $I'$ tale che $W(I') > W(X)$.

Poiché (S, F) `e un matroide, sappiamo che I ′ deve contenere almeno un elemento in pi`u rispetto a X (ovvero |I ′ | > |X|). Tuttavia, l’algoritmo greedy standard aggiunge elementi uno alla volta, quindi |X| raggiunge |I ′ | solo nel passo successivo.