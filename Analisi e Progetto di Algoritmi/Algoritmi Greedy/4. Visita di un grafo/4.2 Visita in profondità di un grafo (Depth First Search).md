## Depth First Search $DFS(G)$
Una visita in profondità di un grafo $G$ si svolge come segue:
- sceglie un vertice $s$, come sorgente, e visita $s$
- visita il primo adiacente $a_1$ di $s$, poi visita il primo adiacente $a_2$ di $a_1$, poi visita il primo adiacente $a_3$ di $a_2$, etc...
- quando raggiunge un vertice che non ha adiacenti da visitare **risale al predecessore** e la visita riparte *(se possible)* da un altro adiacente di tale predecessore
- ogni volta che non ci sono adiacenti da visitare si risale al predecessore
- quando la visita risale alla sorgente $s$ e $s$ non ha più adiacenti da visitare, si sceglie una nuova sorgente e la visita riparte
- la visita **termina** quando non ci sono più vertici disponibili per essere scelti come nuova sorgente

>[!Note]
>Attraverso $DFS$, al contrario di $BFS$, visiteremo **tutti** i vertici del grafo iniziale $G$.

I vertici hanno associato un **colore**:
1. $Bianco \rightarrow$ vertice non ancora visitato
2. $Grigio \rightarrow$ vertice visitato *(archi uscenti ancora da ispezionare)*
3. $Nero \rightarrow$ vertice visitato *(adiacenti completamente visitati)*

#### Strutture di base
Posso rappresentare in pseudocodice $DFS$ definendo alcune strutture base che mi serviranno nella realizzazione del codice:
- $color \rightarrow$ vettore dei **colori** di lunghezza $|V|$
	- `prima` della visita $\rightarrow$ $color[v] = Bianco$ per ogni vertice $v$
	- `dopo` la visita $\rightarrow$ $color[v] = Nero$ per ogni vertice $v$
	- `dopo` la visita $\rightarrow$ $color[v] = Bianco$ per **nessun** vertice $v$
	- `durante` la visita $\rightarrow$ $color[v] = Grigio$ se $v$ *(visitato)* ha ancora archi uscenti da ispezionare

- $\pi \rightarrow$ vettore dei **predecessori** di lunghezza $|V|$
	- `prima` della visita $\rightarrow$ $\pi[v] = NIL$ per ogni $v$
	- `dopo` la visita $\rightarrow$ $\pi[v] = NIL$ per ogni $v$ che è sorgente
	- `dopo` la visita $\rightarrow$ $\pi[v] = u$ predecessore di $v$ nella visita, per ogni $v$ che **non** è sorgente; si ha $(u,v) ∈ E$

- $d \rightarrow$ vettore dei **tempi di scoperta** di lunghezza $|V|$
	- $d[v] \rightarrow$ istante in cui $v$ diventa $Grigio$ *(scoperta)*

- $f \rightarrow$ vettore dei **tempi di completamento** di lunghezza $|V|$
	- $f[v] \rightarrow$ istante in cui $v$ diventa $Nero$ *(completamento)*

>[!Note]
>- $d[v], f[v] ∈ \{1,2,…, 2|V|\}$
>- $d[v] < f[v]$ per ogni vertice $v$
>- $[d[v], f[v]] \rightarrow$ intervallo temporale di $v$

---
## Teorema delle Parentesi
Dopo una visita in profondità, uno solo dei **tre casi** seguenti si può verificare per due vertici $u$ e $v$:
1. $[d[u],f[u]]$ contiene $[d[v],f[v]] \rightarrow$ $v$ è discendente di $u$ in un albero della visita
2. $[d[v],f[v]]$ contiene $[d[u],f[u]] \rightarrow$ $u$ è discendente di $v$ in un albero della visita
3. $[d[u],f[u]]$ e $[d[v],f[v]]$ sono disgiunti $\rightarrow$ $u$ e $v$ **non** sono discendenti l’uno dell’altro in un albero della visita



![[Pasted image 20231230170249.png]]